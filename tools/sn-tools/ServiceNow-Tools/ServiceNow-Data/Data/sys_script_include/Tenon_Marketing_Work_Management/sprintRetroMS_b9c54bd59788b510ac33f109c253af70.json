{
  "_metadata": {
    "table": "sys_script_include",
    "sys_id": "b9c54bd59788b510ac33f109c253af70",
    "extracted_at": "2025-09-19T21:48:31.448Z",
    "display_value": "sprintRetroMS",
    "application": "Tenon_Marketing_Work_Management",
    "scope": {
      "display_value": "Tenon Marketing Work Management",
      "link": "https://tenonworkstudio.service-now.com/api/now/table/sys_scope/4e4449a5475c255085d19fd8036d43a0",
      "value": "4e4449a5475c255085d19fd8036d43a0"
    }
  },
  "client_callable": {
    "value": "false",
    "display_value": "false"
  },
  "access": {
    "value": "public",
    "display_value": "All application scopes"
  },
  "mobile_callable": {
    "value": "false",
    "display_value": "false"
  },
  "sys_mod_count": {
    "value": "36",
    "display_value": "36"
  },
  "active": {
    "value": "true",
    "display_value": "true"
  },
  "description": {
    "value": "",
    "display_value": ""
  },
  "sys_updated_on": {
    "value": "2025-03-11 20:56:43",
    "display_value": "2025-03-11 01:56:43 PM"
  },
  "sys_tags": {
    "value": "",
    "display_value": ""
  },
  "sandbox_callable": {
    "value": "false",
    "display_value": "false"
  },
  "script": {
    "value": "const sprintRetroMS = Class.create();\r\nsprintRetroMS.prototype = {\r\n\tinitialize: function () {},\r\n\r\n\tcreateOrDeleteRetro: function (sprintGr) {\r\n\t\tconst sprintSysId = sprintGr.getUniqueValue();\r\n\t\tconst sprintDisplayValue = sprintGr.getDisplayValue();\r\n\t\tconst { tasksCompleted, tasksTotal, storyPointsTotal, storyPointsCompleted } = this.getTaskAgg(sprintSysId);\r\n\r\n\t\tconst currentStatus = sprintGr.getValue(\"state\");\r\n\r\n\t\tif (currentStatus === \"40\") {\r\n\t\t\tconst newRetroGr = new GlideRecordSecure(\"x_cadso_work_sprint_retro\");\r\n\t\t\tnewRetroGr.setValue(\"segment\", sprintGr.getValue(\"segment\"));\r\n\t\t\tnewRetroGr.setValue(\"assignment_group\", sprintGr.getValue(\"assignment_group\"));\r\n\t\t\tnewRetroGr.setValue(\"assigned_to\", sprintGr.getValue(\"assigned_to\"));\r\n\t\t\tnewRetroGr.setValue(\"tasks_completed\", tasksCompleted);\r\n\t\t\tnewRetroGr.setValue(\"tasks_total\", tasksTotal);\r\n\t\t\tnewRetroGr.setValue(\"story_points_total\", storyPointsTotal);\r\n\t\t\tnewRetroGr.setValue(\"story_points_completed\", storyPointsCompleted);\r\n\t\t\tnewRetroGr.setValue(\"sprint\", sprintSysId);\r\n\t\t\tnewRetroGr.setValue(\"description\", `Retro for ${sprintDisplayValue}`);\r\n\t\t\tnewRetroGr.setValue(\"short_description\", `${sprintDisplayValue} Retro`);\r\n\t\t\tnewRetroGr.setValue(\"state\", \"30\");\r\n\t\t\tnewRetroGr.insert();\r\n\t\t} else if (currentStatus === \"30\" || currentStatus === \"10\") {\r\n\t\t\tconst existingRetroGr = new GlideRecordSecure(\"x_cadso_work_sprint_retro\");\r\n\t\t\texistingRetroGr.addQuery(\"sprint\", sprintSysId);\r\n\t\t\texistingRetroGr.query();\r\n\r\n\t\t\tif (existingRetroGr.next()) {\r\n\t\t\t\texistingRetroGr.deleteRecord();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n  getTaskAgg: function (sprintSysId) {\r\n    let tasksCompleted = 0;\r\n    let tasksTotal = 0;\r\n    let storyPointsTotal = 0;\r\n    let storyPointsCompleted = 0;\r\n\r\n    let taskAgg = new GlideAggregate(\"x_cadso_work_task\");\r\n    taskAgg.addQuery(\"sprint\", sprintSysId);\r\n    taskAgg.groupBy(\"sprint\");\r\n    taskAgg.addAggregate(\"SUM\", \"story_points\");\r\n    taskAgg.addAggregate(\"COUNT\");\r\n    taskAgg.query();\r\n\r\n    if (taskAgg.next()) {\r\n      tasksTotal = taskAgg.getAggregate(\"COUNT\") || 0;\r\n      storyPointsTotal = taskAgg.getAggregate(\"SUM\", \"story_points\") || 0;\r\n    }\r\n\r\n    taskAgg = new GlideAggregate(\"x_cadso_work_task\");\r\n    taskAgg.addQuery(\"sprint\", sprintSysId);\r\n    taskAgg.addQuery(\"state\", \"40\");\r\n    taskAgg.groupBy(\"sprint\");\r\n    taskAgg.addAggregate(\"SUM\", \"story_points\");\r\n    taskAgg.addAggregate(\"COUNT\");\r\n    taskAgg.query();\r\n\r\n    if (taskAgg.next()) {\r\n      tasksCompleted = taskAgg.getAggregate(\"COUNT\") || 0;\r\n      storyPointsCompleted = taskAgg.getAggregate(\"SUM\", \"story_points\") || 0;\r\n    }\r\n\r\n    return { tasksCompleted, tasksTotal, storyPointsTotal, storyPointsCompleted };\r\n  },\r\n\r\n  type: \"sprintRetroMS\",\r\n};\r\n",
    "display_value": "const sprintRetroMS = Class.create();\r\nsprintRetroMS.prototype = {\r\n\tinitialize: function () {},\r\n\r\n\tcreateOrDeleteRetro: function (sprintGr) {\r\n\t\tconst sprintSysId = sprintGr.getUniqueValue();\r\n\t\tconst sprintDisplayValue = sprintGr.getDisplayValue();\r\n\t\tconst { tasksCompleted, tasksTotal, storyPointsTotal, storyPointsCompleted } = this.getTaskAgg(sprintSysId);\r\n\r\n\t\tconst currentStatus = sprintGr.getValue(\"state\");\r\n\r\n\t\tif (currentStatus === \"40\") {\r\n\t\t\tconst newRetroGr = new GlideRecordSecure(\"x_cadso_work_sprint_retro\");\r\n\t\t\tnewRetroGr.setValue(\"segment\", sprintGr.getValue(\"segment\"));\r\n\t\t\tnewRetroGr.setValue(\"assignment_group\", sprintGr.getValue(\"assignment_group\"));\r\n\t\t\tnewRetroGr.setValue(\"assigned_to\", sprintGr.getValue(\"assigned_to\"));\r\n\t\t\tnewRetroGr.setValue(\"tasks_completed\", tasksCompleted);\r\n\t\t\tnewRetroGr.setValue(\"tasks_total\", tasksTotal);\r\n\t\t\tnewRetroGr.setValue(\"story_points_total\", storyPointsTotal);\r\n\t\t\tnewRetroGr.setValue(\"story_points_completed\", storyPointsCompleted);\r\n\t\t\tnewRetroGr.setValue(\"sprint\", sprintSysId);\r\n\t\t\tnewRetroGr.setValue(\"description\", `Retro for ${sprintDisplayValue}`);\r\n\t\t\tnewRetroGr.setValue(\"short_description\", `${sprintDisplayValue} Retro`);\r\n\t\t\tnewRetroGr.setValue(\"state\", \"30\");\r\n\t\t\tnewRetroGr.insert();\r\n\t\t} else if (currentStatus === \"30\" || currentStatus === \"10\") {\r\n\t\t\tconst existingRetroGr = new GlideRecordSecure(\"x_cadso_work_sprint_retro\");\r\n\t\t\texistingRetroGr.addQuery(\"sprint\", sprintSysId);\r\n\t\t\texistingRetroGr.query();\r\n\r\n\t\t\tif (existingRetroGr.next()) {\r\n\t\t\t\texistingRetroGr.deleteRecord();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n  getTaskAgg: function (sprintSysId) {\r\n    let tasksCompleted = 0;\r\n    let tasksTotal = 0;\r\n    let storyPointsTotal = 0;\r\n    let storyPointsCompleted = 0;\r\n\r\n    let taskAgg = new GlideAggregate(\"x_cadso_work_task\");\r\n    taskAgg.addQuery(\"sprint\", sprintSysId);\r\n    taskAgg.groupBy(\"sprint\");\r\n    taskAgg.addAggregate(\"SUM\", \"story_points\");\r\n    taskAgg.addAggregate(\"COUNT\");\r\n    taskAgg.query();\r\n\r\n    if (taskAgg.next()) {\r\n      tasksTotal = taskAgg.getAggregate(\"COUNT\") || 0;\r\n      storyPointsTotal = taskAgg.getAggregate(\"SUM\", \"story_points\") || 0;\r\n    }\r\n\r\n    taskAgg = new GlideAggregate(\"x_cadso_work_task\");\r\n    taskAgg.addQuery(\"sprint\", sprintSysId);\r\n    taskAgg.addQuery(\"state\", \"40\");\r\n    taskAgg.groupBy(\"sprint\");\r\n    taskAgg.addAggregate(\"SUM\", \"story_points\");\r\n    taskAgg.addAggregate(\"COUNT\");\r\n    taskAgg.query();\r\n\r\n    if (taskAgg.next()) {\r\n      tasksCompleted = taskAgg.getAggregate(\"COUNT\") || 0;\r\n      storyPointsCompleted = taskAgg.getAggregate(\"SUM\", \"story_points\") || 0;\r\n    }\r\n\r\n    return { tasksCompleted, tasksTotal, storyPointsTotal, storyPointsCompleted };\r\n  },\r\n\r\n  type: \"sprintRetroMS\",\r\n};\r\n",
    "formatted_script": {
      "line_count": 73,
      "char_count": 2746,
      "preview": "const sprintRetroMS = Class.create();\r\nsprintRetroMS.prototype = {\r\n\tinitialize: function () {},\r\n\r\n\tcreateOrDeleteRetro: function (sprintGr) {\r\n\t\tconst sprintSysId = sprintGr.getUniqueValue();\r\n\t\tcon...",
      "full_script": "const sprintRetroMS = Class.create();\r\nsprintRetroMS.prototype = {\r\n\tinitialize: function () {},\r\n\r\n\tcreateOrDeleteRetro: function (sprintGr) {\r\n\t\tconst sprintSysId = sprintGr.getUniqueValue();\r\n\t\tconst sprintDisplayValue = sprintGr.getDisplayValue();\r\n\t\tconst { tasksCompleted, tasksTotal, storyPointsTotal, storyPointsCompleted } = this.getTaskAgg(sprintSysId);\r\n\r\n\t\tconst currentStatus = sprintGr.getValue(\"state\");\r\n\r\n\t\tif (currentStatus === \"40\") {\r\n\t\t\tconst newRetroGr = new GlideRecordSecure(\"x_cadso_work_sprint_retro\");\r\n\t\t\tnewRetroGr.setValue(\"segment\", sprintGr.getValue(\"segment\"));\r\n\t\t\tnewRetroGr.setValue(\"assignment_group\", sprintGr.getValue(\"assignment_group\"));\r\n\t\t\tnewRetroGr.setValue(\"assigned_to\", sprintGr.getValue(\"assigned_to\"));\r\n\t\t\tnewRetroGr.setValue(\"tasks_completed\", tasksCompleted);\r\n\t\t\tnewRetroGr.setValue(\"tasks_total\", tasksTotal);\r\n\t\t\tnewRetroGr.setValue(\"story_points_total\", storyPointsTotal);\r\n\t\t\tnewRetroGr.setValue(\"story_points_completed\", storyPointsCompleted);\r\n\t\t\tnewRetroGr.setValue(\"sprint\", sprintSysId);\r\n\t\t\tnewRetroGr.setValue(\"description\", `Retro for ${sprintDisplayValue}`);\r\n\t\t\tnewRetroGr.setValue(\"short_description\", `${sprintDisplayValue} Retro`);\r\n\t\t\tnewRetroGr.setValue(\"state\", \"30\");\r\n\t\t\tnewRetroGr.insert();\r\n\t\t} else if (currentStatus === \"30\" || currentStatus === \"10\") {\r\n\t\t\tconst existingRetroGr = new GlideRecordSecure(\"x_cadso_work_sprint_retro\");\r\n\t\t\texistingRetroGr.addQuery(\"sprint\", sprintSysId);\r\n\t\t\texistingRetroGr.query();\r\n\r\n\t\t\tif (existingRetroGr.next()) {\r\n\t\t\t\texistingRetroGr.deleteRecord();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n  getTaskAgg: function (sprintSysId) {\r\n    let tasksCompleted = 0;\r\n    let tasksTotal = 0;\r\n    let storyPointsTotal = 0;\r\n    let storyPointsCompleted = 0;\r\n\r\n    let taskAgg = new GlideAggregate(\"x_cadso_work_task\");\r\n    taskAgg.addQuery(\"sprint\", sprintSysId);\r\n    taskAgg.groupBy(\"sprint\");\r\n    taskAgg.addAggregate(\"SUM\", \"story_points\");\r\n    taskAgg.addAggregate(\"COUNT\");\r\n    taskAgg.query();\r\n\r\n    if (taskAgg.next()) {\r\n      tasksTotal = taskAgg.getAggregate(\"COUNT\") || 0;\r\n      storyPointsTotal = taskAgg.getAggregate(\"SUM\", \"story_points\") || 0;\r\n    }\r\n\r\n    taskAgg = new GlideAggregate(\"x_cadso_work_task\");\r\n    taskAgg.addQuery(\"sprint\", sprintSysId);\r\n    taskAgg.addQuery(\"state\", \"40\");\r\n    taskAgg.groupBy(\"sprint\");\r\n    taskAgg.addAggregate(\"SUM\", \"story_points\");\r\n    taskAgg.addAggregate(\"COUNT\");\r\n    taskAgg.query();\r\n\r\n    if (taskAgg.next()) {\r\n      tasksCompleted = taskAgg.getAggregate(\"COUNT\") || 0;\r\n      storyPointsCompleted = taskAgg.getAggregate(\"SUM\", \"story_points\") || 0;\r\n    }\r\n\r\n    return { tasksCompleted, tasksTotal, storyPointsTotal, storyPointsCompleted };\r\n  },\r\n\r\n  type: \"sprintRetroMS\",\r\n};\r\n"
    }
  },
  "sys_class_name": {
    "value": "sys_script_include",
    "display_value": "Script Include"
  },
  "sys_package": {
    "value": "4e4449a5475c255085d19fd8036d43a0",
    "display_value": "Tenon Marketing Work Management"
  },
  "sys_update_name": {
    "value": "sys_script_include_b9c54bd59788b510ac33f109c253af70",
    "display_value": "sys_script_include_b9c54bd59788b510ac33f109c253af70"
  },
  "sys_updated_by": {
    "value": "trevor.offen",
    "display_value": "trevor.offen"
  },
  "api_name": {
    "value": "x_cadso_work.sprintRetroMS",
    "display_value": "x_cadso_work.sprintRetroMS"
  },
  "sys_created_on": {
    "value": "2023-07-14 19:53:17",
    "display_value": "2023-07-14 12:53:17 PM"
  },
  "caller_access": {
    "value": "",
    "display_value": null
  },
  "name": {
    "value": "sprintRetroMS",
    "display_value": "sprintRetroMS"
  },
  "sys_name": {
    "value": "sprintRetroMS",
    "display_value": "sprintRetroMS"
  },
  "sys_scope": {
    "value": "4e4449a5475c255085d19fd8036d43a0",
    "display_value": "Tenon Marketing Work Management"
  },
  "sys_created_by": {
    "value": "daniel.cudney",
    "display_value": "daniel.cudney"
  },
  "sys_policy": {
    "value": "read",
    "display_value": "Read-only"
  }
}
